<?xml version='1.0' encoding='UTF-8' ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <head>
        <title>Directory - <h:outputText value="#{browseBean.directory.name}"/></title>
        <link href="#{facesContext.externalContext.requestContextPath}/_/style.css" rel="stylesheet" type="text/css"/>
    </head>
    <body>
        <b><h:outputText value="#{browseBean.directory.name}"/></b>
        <div style="float: right; vertical-align: bottom;">
            <h:form id="form_create_directory">
                <h:commandButton class="button" id="createDirectoryButton" value="Create Directory" action="#{browseBean.createDirectory}">
                    <f:param name="directoryPath" value="#{browseBean.directoryPath}"/>
                </h:commandButton>
            </h:form>
        </div>
        <table width="100%">
            <tr>
                <th>&#160;</th>
                <th>Name</th>
                <th>Actions</th>
            </tr>
            <tr>
                <td>&#160;</td>
                <td>
                    <h:form id="form_back">
                        <h:outputLink value="#{facesContext.externalContext.requestContextPath}/#{browseBean.directoryPath}/.." rendered="#{not empty browseBean.directoryPath}">
                            <h:outputText value=".."/>
                        </h:outputLink>
                    </h:form>
                </td>
            </tr>
            <ui:repeat value="#{browseBean.directory.files}" var="file" varStatus="status">
                <tr>
                    <h:form id="form">
                        <td>&#160;</td>
                        <td>

                            <h:outputLink value="#{facesContext.externalContext.requestContextPath}/download/#{browseBean.directoryPath}/#{file.name}" rendered="#{not empty browseBean.directoryPath}">
                                <h:outputText value="#{file.name}" rendered="#{not file.attributes.directory}"/>
                            </h:outputLink>
                            <h:outputLink value="#{facesContext.externalContext.requestContextPath}/download/#{file.name}" rendered="#{empty browseBean.directoryPath}">
                                <h:outputText value="#{file.name}" rendered="#{not file.attributes.directory}"/>
                            </h:outputLink>
                            <h:outputLink id="button_#{status.index}_a" value="#{facesContext.externalContext.requestContextPath}/#{browseBean.directoryPath}/#{file.name}" rendered="#{file.attributes.directory and not empty browseBean.directoryPath}">
                                <h:outputText value="#{file.name}"/>
                            </h:outputLink>
                            <h:outputLink id="button_#{status.index}_b" value="#{facesContext.externalContext.requestContextPath}/#{file.name}" rendered="#{file.attributes.directory and empty browseBean.directoryPath}">
                                <h:outputText value="#{file.name}"/>
                            </h:outputLink>
                        </td>
                        <td>
                            <h:button class="button" id="deleteFileButton_#{status.index}" value="delete" outcome="delete_file">
                                <f:param name="directoryPath" value="#{browseBean.directoryPath}"/>
                                <f:param name="filename" value="#{file.name}"/>
                            </h:button>
                        </td>
                    </h:form>
                </tr>
            </ui:repeat>
            <tr>
                <th width="25px">&#160;</th>
                <th>&#160;</th>
                <th>&#160;</th>
            </tr>
        </table>
        <div>
            <div style="float: left; vertical-align: bottom;">
                <h:form id="form_upload" enctype="multipart/form-data">
                    <h:inputFile class="button" id="fileUpload" value="#{browseBean.file}"/>
                    <h:commandButton class="button" id="uploadButton" value="Upload" action="#{browseBean.upload}">
                        <f:param name="directory" value="#{browseBean.directoryPath}"/>
                    </h:commandButton>
                </h:form>
            </div>
        </div>
    </body>
</html>
